<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Mothers Day Project</title>
        <style>
            body {
                position: fixed;
            }
            #canvi {
                margin: -10px;
            }
        </style>
    </head>
<body>
    <canvas id="canvi"></canvas>
    <script>
        // makes it more like javascript
        var canvas = document.getElementById("canvi");
        var ctx = canvas.getContext("2d");
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        var mouseX = 0;
        var mouseY = 0;
        var clicked = false
        var keys = [];
        canvas.addEventListener("mousemove", function(e) {
            var cRect = canvas.getBoundingClientRect();
            mouseX = Math.round(e.clientX - cRect.left);
            mouseY = Math.round(e.clientY - cRect.top);
        });
        canvas.addEventListener("mousedown", function(e) {
            dragged = true;
        }, false);
        canvas.addEventListener("mouseup", function(e) {
            if(dragged === true) {
                clicked = true;
                dragged = false;
            }
        });
        window.addEventListener("keydown", keysPressed, false);
        window.addEventListener("keyup", keysReleased, false);
        function keysPressed(e) {
            // store an entry for every key pressed
            keys[e.keyCode] = true;
            e.preventDefault();
        }
        function keysReleased(e) {
            // mark keys that were released
            keys[e.keyCode] = false;
        }
        function cos(r) {
            return Math.cos(r);
        }
        function sin(r) {
            return Math.sin(r);
        }
        function atan2(y, x) {
            return Math.atan2(y, x);
        }
        function round(num) {
            return Math.round(num);
        }
        function random(min, max) {
            return min + Math.random(0, 1) * (max - min);
        }
        function dist(x, y, x2, y2) {
            var a = x - x2;
            var b = y - y2;
            return Math.sqrt(a * a + b * b);
        }
        function text(txt, x, y, size) {
            ctx.font = size + "px Arial";
            ctx.fillText(txt, x, y);
        }
        function fill(r, g, b, a) {
            if(a === undefined) {
                a = 1;
            }
            ctx.fillStyle = "rgba(" + r + ", " + g + ", " + b + ", " + a + ")";
        }
        function stroke(r, g, b) {
            ctx.strokeStyle = "rgb(" + r + ", " + g + ", " + b + ")";
        }
        function rect(x, y, w, h, r) {
            ctx.save();
            ctx.translate(x, y)
            ctx.rotate(r);
            ctx.fillRect(0, 0, w, h);
            ctx.restore();
        }
        function strokeWeight(s) {
            ctx.lineWidth = s;
        }
        function eRect(x, y, w, h, col) {
            ctx.beginPath();
            stroke(col[0], col[1], col[2]);
            ctx.rect(x, y, w, h);
            ctx.stroke();
        }
        function start() {
            var myVar = setInterval(draw, 1);
        }
        function textAlign(align) {
            ctx.textAlign = align;
        }
        function lerp(a, b, t) {
            return a + (b - a) * t;
        }
        function dist2(a, b, d) {
            return (a - b) > -d && (a - b) < d;
        }
        function ellipse(x, y, radiusX, radiusY, rotation) {
            ctx.beginPath();
            ctx.ellipse(x, y, radiusX, radiusY, rotation, 0, 2 * Math.PI);
            ctx.fill();
        }
        function eEllipse(x, y, radiusX, radiusY, rotation) {
            ctx.beginPath();
            ctx.ellipse(x, y, radiusX, radiusY, rotation, 0, 2 * Math.PI);
            ctx.stroke();
        }
        function constrain(num, m, ma) {
            if(num < m) {
                num = m;
            } else if(num > ma) {
                num = ma;
            }
            return num;
        }
    </script>
<script>
var scene = "";
textAlign("center");
var slide = 0;
var targSlide = 0;
var confettis = [];
var t = 10;
var scene = "well";
var holding = "";
var gearStats = {
    x: 25,
    y: 25,
};

function confetti(x, y) {
    this.x = x;
    this.y = y;
    this.r = round(random(0, 360));
    this.w = round(random(3, 5));
    this.aX = round(random(-3, 3));
    this.aY = round(random(-3, 3));
    this.aR = random(-1, 1);
    this.h = this.w * 1.5;
    this.col = [[255, 0, 0], [0, 255, 0], [0, 0, 255], [255, 255, 255], [0, 255, 255], [255, 255, 0], [255, 0, 255]];
    this.chosen = round(random(0, this.col.length - 1));
}
confetti.prototype.draw = function() {
    fill(this.col[this.chosen][0], this.col[this.chosen][1], this.col[this.chosen][2]);
    rect(this.x, this.y, this.w, this.h, this.r);
}
confetti.prototype.update = function() {
    this.x+=this.aX;
    this.y+=this.aY;
    this.r+=this.aR;
    this.aY+=0.1;
}
for(var i = 0; i < 100; i+=1) {
    confettis.push(new confetti(round(random(0, canvas.width)), -100))
}

function button(x, y, w, h, d) {
    rect(x, y, w, h);
    if(clicked && mouseX > x && mouseY > y && mouseX < x + w && mouseY < y + h) {
        d();
        clicked = false;
    }
}

function gear(x, y) {
    fill(5, 5, 5)
    button(x - 15, y - 15, 30, 30, function() {
        if(holding !== "gear") {
            holding = "gear";
        } else {
            holding = "";
        }
        gearStats.x = mouseX;
        gearStats.y = mouseY;
    });
    fill(200, 200, 200);
    ellipse(x, y, 15, 15, 0);
    for(var i = 0; i < 13; i+=1) {
        rect(x, y, 20, 5, i * 0.47)
    }
    fill(5, 5, 5);
    ellipse(x, y, 10, 10, 0);
}

function gear2(x, y) {
    fill(5, 5, 5)
    button(x - 15, y - 15, 30, 30, function() {
        if(holding == "gear") {
            scene = "WIN";
            holding = "";
            gearStats.x = -1000;
        }
    });
    fill(200, 200, 200);
    ellipse(x, y, 15, 15, 0);
    for(var i = 0; i < 13; i+=1) {
        rect(x, y, 20, 5, i * 0.47)
    }
    fill(5, 5, 5);
    ellipse(x, y, 10, 10, 0);
}

function draw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    switch(scene) {
        case "well":
            // {
            fill(5, 5, 5);
            rect(slide, 0, canvas.width, canvas.height);
            fill(255, 255, 255);
            text("Happy Mothers Day", canvas.width/2 + slide, canvas.height/2, 40);
            text("Arrow keys to move", canvas.width/2 + slide, canvas.height/2 + 30, 20)
            // } first slide
            // {
            fill(5, 5, 5);
            rect(canvas.width + slide, 0, canvas.width, canvas.height);
            fill(255, 255, 255);
            text("Click For Confetti", canvas.width + canvas.width/2 + slide, canvas.height/2, 40);
            // } second slide
            // {
            fill(5, 5, 5);
            rect(canvas.width * 2 + slide, 0, canvas.width, canvas.height);
            fill(255, 255, 255);
            text("10101010110101", canvas.width * 2 + canvas.width/2 + slide, canvas.height/2, 40);
            fill(100, 100, 100);
            button(canvas.width * 2 + slide, 0, 100, 100, function() {
                scene = "Backspace"
            });
            fill(255, 255, 255);
            for(var i = 0; i < 14; i+=1) {
                for(var j = 0; j < 10; j+=1) {
                    text(round(random(0, 1)), 5 + canvas.width * 2 + slide + i * 7, 10 + j * 10, 10)
                }
            }
            // } third slide
            if(clicked) {
                for(var i = 0; i < 10; i+=1) {
                    confettis.push(new confetti(mouseX + round(random(-10, 10)), mouseY + round(random(-10, 10))));
                }
            }
            if(keys[39] && t <= 0) {
                targSlide -= canvas.width;
                t = 60;
            }
            if(keys[37] && t <= 0) {
                targSlide += canvas.width;
                t = 60;
            }
            for(var i = 0; i < confettis.length; i+=1) {
                confettis[i].draw();
                confettis[i].update();
                if(confettis[i].y > canvas.height + 5) {
                    confettis.splice(i, 1);
                }
            }
            targSlide = constrain(targSlide, -canvas.width * 2, 0);
            slide = lerp(slide, targSlide, 0.05);
        break;
        case "Backspace":
            fill(5, 5, 5);
            rect(0, 0, canvas.width, canvas.height);
            fill(255, 255, 255);
            text("Help the thing is broken (it seems to need a gear)", canvas.width/2, canvas.height/2, 20);
            fill(100, 100, 100);
            button(canvas.width - 100, 0, 100, 100, function() {
                scene = "well"
            });
            fill(255, 255, 255);
            for(var i = 0; i < 14; i+=1) {
                for(var j = 0; j < 10; j+=1) {
                    text(round(random(0, 1)), -5 + canvas.width - i * 7, 10 + j * 10, 10)
                }
            }
            gear2(canvas.width/2 - 12.5, canvas.height/2 + 50);
        break;
        case "WIN":
            fill(5, 5, 5);
            rect(0, 0, canvas.width, canvas.height);
            fill(255, 255, 255);
            text("Thank you for saving program!", canvas.width/2, canvas.height/2, 30);
        break
    }
    // {
    gear(gearStats.x, gearStats.y);
    if(holding === "gear") {
        gearStats.x = mouseX;
        gearStats.y = mouseY;
    }
    // } gear updates and sutff
    clicked = false;
    t-=1;
};
start();
</script>
</body>
</html>
